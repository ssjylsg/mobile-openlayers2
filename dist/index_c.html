<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="theme/default/style.mobile.css" type="text/css">
    <style>
    html,
    body {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
    }
    
    @media only screen and (max-width: 600px) {
        html,
        body {
            height: 117%;
        }
    }
    
    .olControlAttribution {
        position: absolute;
        font-size: 10px;
        bottom: 0 !important;
        right: 0 !important;
        background: rgba(0, 0, 0, 0.1);
        font-family: Arial;
        padding: 2px 4px;
        border-radius: 5px 0 0 0;
    }
    
    #viewerContainer {
        width: 100%;
        position: absolute;
        height: 100%;
    }
    </style>
</head>
<body>   
     <div>
        <div id="viewerContainer"></div>
        <div id="iploc" class="ipLocCont BMap_noprint anchorBR" style="position: absolute; z-index: 10; bottom: 50px; right: 10px; top: auto; left: auto;">
            <div class="titleComm title hide">定位您的位置</div>
            <div class="hide titleComm loading-button">定位中</div>
            <div class="hide titleComm titleFailed">定位失败</div>
            <div class="icon"> <span class="success">        </span> </div>
        </div>
    </div>
    <script src="WebViewJavascriptBridge.js"></script>
    <script src="jquery.js"></script>
    <script src="OpenLayers.js"></script>
    <script src="NPMobileMap.js"></script>
    <script src="json2.js"></script>
    <script type="text/javascript">
    var map;
    var fixSize = function() {
        window.scrollTo(0, 0);
        document.body.style.height = '100%';
        if (!(/(iphone|ipod)/.test(navigator.userAgent.toLowerCase()))) {
            if (document.body.parentNode) {
                document.body.parentNode.style.height = '100%';
            }
        }
    };
    setTimeout(fixSize, 700);
    setTimeout(fixSize, 1500);

    function connectWebViewJavascriptBridge(callback) {
        if (window.WebViewJavascriptBridge) {
            callback(WebViewJavascriptBridge)
        } else {
            document.addEventListener(
                'WebViewJavascriptBridgeReady',
                function() {
                    callback(WebViewJavascriptBridge)
                },
                false
            );
        }
    }

    connectWebViewJavascriptBridge(function(bridge) {
        bridge.init(function(message, responseCallback) {
            console.log('JS got a message', message);
            var data = {
                'Javascript Responds': '测试中文!'
            };
            console.log('JS responding with', data);
            responseCallback(data);
        });

        bridge.registerHandler("functionInJs", function(data, responseCallback) {
            try {
                document.getElementById("show").innerHTML = ("data from Java: = " + data);
            } catch (ex) {
                document.getElementById("show").innerHTML = "error";
            }
            var responseData = "Javascript Says Right back aka!";
            responseCallback(responseData);
        });

        bridge.registerHandler("NPMobileHelper.callMethod", function(data, responseCallback) {
            responseCallback(NPMobileHelper.callMethod.apply(NPMobileHelper, data));
        });

    });

    $("input").click(function(event) {
        var data = {
            id:1,
            eventType:'clcik'
        };
        window.WebViewJavascriptBridge.callHandler(
            'NPMobileHelper.Event.Call', data,
            function(responseData) {

            }
        );
    });
    </script>
</body>

</html>
